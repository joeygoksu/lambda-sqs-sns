# Answer for Q2

1. One possible way we could lose writes is if the stream processing node dies before the KV writes are persisted to the separate Kafka topic. This could happen if the node crashes or is shut down unexpectedly, and the KV writes are not flushed to disk before the node goes offline. Another possible way we could lose writes is if the KV writes are lost or corrupted during replication or transport on the separate Kafka topic. This could happen if there are errors in the network or the Kafka brokers, or if the KV writes are not properly serialized or encoded.

2. To test and reproduce the failure, we could simulate high load on the system by generating and sending a large volume of transactions through the Kafka topic. We could then shut down the stream processing node unexpectedly, either by manually stopping the node or by simulating a crash or power outage. After restarting the node, we could check the account balances in the KV database to see if any of the writes were lost.

3. To isolate the failure modes, we could first try reproducing the failure without shutting down the stream processing node. This would allow us to determine whether the problem is caused by loss of KV writes during transport or replication on the separate Kafka topic. If the problem still occurs without shutting down the node, we could then try reproducing the failure with the node running on a different machine, to see if the problem is caused by the node's local KV database being recreated from the state topic. This would allow us to determine whether the problem is caused by loss of KV writes on the local machine or on the separate Kafka topic.
